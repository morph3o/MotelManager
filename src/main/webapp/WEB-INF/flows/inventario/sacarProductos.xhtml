<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/layouts/relative_layout_app.xhtml">

	<ui:define name="content">
		<div class="row-fluid">
			<div class="span12">
	            <h1>Retiro de Productos</h1>
	        </div>
	        <h:form id="salidaProductos" style="margin-top: 15px;" prependId="false">
	        	<p:growl id="growl" showDetail="false" life="2000" widgetVar="growl" />
	        	<div class="row-fluid formHeader">	          
		              <fieldset class="span7" style="margin-left: 0px; margin-top: 15px;">
		                  <div class="control-group">
		                     <label class="control-label" for="inputEmail">ID Salida</label>
		                     <div class="controls">
		                     	<p:inputText id="id_salida" value="#{salidasBean.idSalida}" readonly="true" styleClass="form-input" style="margin-left: 11px;"></p:inputText>
		                     </div>
		                  </div>
		                  <div class="control-group">
		                     <label class="control-label" for="fecha">Fecha</label>
		                     <div class="controls">
								<p:calendar id="fecha" value="#{salidasBean.fechaSalida}" style="margin-left: 33px;" styleClass="form-input" readonlyInput="true" pattern="dd/MM/yyyy" />
		                     </div>
		                  </div>
		              </fieldset>
		              <fieldset class="span4" style="margin-left: 110px; margin-top: 15px;">
		                  <div class="control-group">
		                     <div class="controls">
		                        <button type="button" class="btn btn-primary" data-toggle="modal" style="margin-left: 143px;" href="#form_add_prod">Agregar Producto</button>
		                     </div>
		                  </div>
		              </fieldset>
		        </div>
		        <div class="span12" style="margin-left: 0px;">
		        	<p:remoteCommand name="eliminarProdLista" update="growl :salidaProductos:tablaProductosEntrada" actionListener="#{salidasBean.eliminarProductoDesdeEntrada}"></p:remoteCommand>
		        	<p:remoteCommand name="ingresarRetiro" update=":salidaProductos growl" oncomplete="jQuery('#confirmar_retiro').modal('hide');" actionListener="#{salidasBean.ingresarSalidas}"></p:remoteCommand>
		        	<p:remoteCommand name="limpiarSalida" update=":salidaProductos growl" oncomplete="jQuery('#confirmar_limpiar').modal('hide');" actionListener="#{salidasBean.init}"></p:remoteCommand>
		        	<h:dataTable id="tablaProductosEntrada" value="#{salidasBean.listaSalidas}" var="salida"
	                            styleClass="table table-hover table-condensed ingresarProdTable" >
	                    <h:column>
	                        <f:facet name="header">ID</f:facet>
	                        #{salida.producto.idProd}
	                    </h:column>
	
	                    <h:column>
	                        <f:facet name="header">Nombre</f:facet>
	                        #{salida.producto.nmProd}
	                    </h:column>
	
	                    <h:column>
	                        <f:facet name="header">Stock</f:facet>
	                        #{salida.cantExtAnt}
	                    </h:column>
	
	                    <h:column>
	                        <f:facet name="header">Egreso</f:facet>
	                        #{salida.cantEgreso}
	                    </h:column>
	
	                    <h:column id="prueba">
	                        <f:facet name="header">Stock Futuro</f:facet>
	                        #{salida.cantExtDesp}
	                    </h:column>
	
	                    <h:column>
	                        <f:facet name="header">Acci√≥n</f:facet>
	                        <a href="#" onclick="eliminarProdLista([{name:'idProd', value:#{salida.producto.idProd}}]);" class="icon-trashcan-2"></a>
	                    </h:column>
	                </h:dataTable>
		        </div>
	        </h:form>
	        <div id="footer-confirmacion" class="span12 form-actions" style="margin-left: 0px;">
	          <button type="submit" class="btn btn-primary pull-right" data-toggle="modal" href="#confirmar_retiro" style="margin-left: 5px;">Confirmar</button>	
	          <button type="button" class="btn pull-right" data-toggle="modal" href="#confirmar_limpiar">Limpiar</button>	          
	        </div>
		</div>
		<script>	
        	setLPTBodyHeight('tablaProductosEntrada','footer-confirmacion');
        </script>
		<!-- MODAL AGREGAR PRODUCTO -->
        <div id="form_add_prod" class="modal hide fade">
	        <div class="modal-header">
	            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
	            <h3>Agregar Producto</h3>
	            <h5>Seleccionar producto y su cantidad a retirar.</h5>
	        </div>
	        <div class="modal-body" style="overflow: hidden;">
	            <h:form class="form-horizontal">
	              <p:remoteCommand name="agregarProdLista" update=":salidaProductos:tablaProductosEntrada :salidaProductos:growl" onsuccess="jQuery('#form_add_prod').modal('hide');" actionListener="#{salidasBean.cargarProductoALista}"></p:remoteCommand>	
	              <div class="control-group">
	                 <label class="control-label" for="lista_prods">Producto</label>
	                 <div class="controls">
			            <h:selectOneMenu id="lista_prods" value="#{salidasBean.prodSelec}">
			            	<f:selectItem itemLabel="Seleccionar Producto" itemValue="" noSelectionOption="true" />
				            <f:selectItems value="#{salidasBean.listaProdDropDown}" />
				       </h:selectOneMenu>
	                 </div>
	              </div>
	              <div class="control-group">
	                 <label class="control-label" for="cant_producto">Cantidad Salida</label>
	                 <div class="controls">
	                    <p:inputText id="cant_producto" type="number"
							value="#{salidasBean.cantidadEgreso}"></p:inputText>
	                 </div>
	              </div>              
	           </h:form>
	        </div>
	        <div class="modal-footer">
	            <a data-dismiss="modal" href="#" class="btn">Cancelar</a>
	            <a href="#" onclick="agregarProdLista();" class="btn btn-primary">Agregar</a>
	        </div>
	    </div>
        <!-- FIN MODAL -->
        <!-- MODAL CONFIRMACION RETIRO PRODUCTOS -->
		<div id="confirmar_retiro" class="modal hide fade">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
				<h3>Confirmar Retiro</h3>
			</div>
			<div class="modal-body">
				<p>Desea confirmar el retiro de los productos desde el stock?</p>
			</div>
			<div class="modal-footer">
				<a href="#" class="btn" onclick="jQuery('#confirmar_retiro').modal('hide');">Cancelar</a>
				<a href="#" class="btn btn-primary" onclick="ingresarRetiro();">Confirmar</a>
			</div>
		</div>
        <!-- FIN MODAL CONFIRMACION RETIRO PRODUCTOS -->
        <!-- MODAL CONFIRMACION LIMPIAR SALIDA -->
		<div id="confirmar_limpiar" class="modal hide fade">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
				<h3>Confirmar Limpiar</h3>
			</div>
			<div class="modal-body">
				<p>Desea confirmar la limpieza de todos los datos ingresados?</p>
			</div>
			<div class="modal-footer">
				<a href="#" class="btn" onclick="jQuery('#confirmar_limpiar').modal('hide');">Cancelar</a>
				<a href="#" class="btn btn-primary" onclick="limpiarSalida();">Confirmar</a>
			</div>
		</div>
        <!-- FIN MODAL CONFIRMACION LIMPIAR SALIDA -->
	</ui:define>
</ui:composition>